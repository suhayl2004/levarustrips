"use strict";(self.webpackChunklevarus=self.webpackChunklevarus||[]).push([[128],{4128:($,u,a)=>{a.r(u),a.d(u,{ReqDetailScreenModule:()=>B});var p=a(177),m=a(9417),b=a(8269),h=a(5248),R=a(5990),t=a(4438);let F=(()=>{class n{constructor(){}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var d=a(4710),S=a(3718),s=a.n(S),l=a(467);class _{constructor(r,e,o){this.loader=r,this.config=e,this.parent=o}upload(){var r=this;return(0,l.A)(function*(){const e=yield r.loader.file;return r.parent.uploadedImageName=e.name,r.read(e)})()}read(r){return new Promise((e,o)=>{const i=new FileReader;i.onload=()=>{e({default:i.result})},i.onerror=c=>{o(c)},i.onabort=()=>{o()},i.readAsDataURL(r)})}abort(){this.reader&&this.reader.abort()}}var x=a(2288),j=a(5702),D=a(8834),f=a(9454),I=a(9213),E=a(6850),T=a(7852);function y(n,r){if(1&n&&t.nrm(0,"div",31),2&n){const e=t.XpG().$implicit;t.Y8G("innerHTML",e.text,t.npT)}}function O(n,r){if(1&n&&t.nrm(0,"ckeditor",32),2&n){const e=t.XpG(4);t.Y8G("editor",e.Editor)}}function A(n,r){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(4);return t.Njj(i.cancelEdit())}),t.EFF(2," Cancel "),t.k0s(),t.j41(3,"button",17),t.bIt("click",function(){t.eBV(e);const i=t.XpG().index,c=t.XpG(3);return t.Njj(c.updateComment(i))}),t.EFF(4," Update "),t.k0s()()}}function P(n,r){if(1&n){const e=t.RV6();t.j41(0,"div",21)(1,"div",22),t.nrm(2,"img",23),t.j41(3,"span",24),t.EFF(4,"Surya - "),t.k0s(),t.j41(5,"span",25),t.EFF(6),t.k0s(),t.j41(7,"div",26)(8,"button",27),t.bIt("click",function(){const i=t.eBV(e).index,c=t.XpG(3);return t.Njj(c.editComment(i))}),t.j41(9,"mat-icon"),t.EFF(10,"edit"),t.k0s()(),t.j41(11,"button",27),t.bIt("click",function(){const i=t.eBV(e).index,c=t.XpG(3);return t.Njj(c.deleteComment(i))}),t.j41(12,"mat-icon"),t.EFF(13,"delete"),t.k0s()()()(),t.j41(14,"div",28),t.DNE(15,y,1,1,"div",29)(16,O,1,1,"ckeditor",30),t.k0s(),t.j41(17,"div",13)(18,"div",14)(19,"div",15),t.DNE(20,A,5,0,"div",6),t.k0s()()()()}if(2&n){const e=r.$implicit,o=r.index,i=t.XpG(3);t.R7$(6),t.JRh(e.timestamp),t.R7$(9),t.Y8G("ngIf",i.editingIndex!==o),t.R7$(),t.Y8G("ngIf",i.editingIndex===o),t.R7$(4),t.Y8G("ngIf",i.editingIndex===o)}}function G(n,r){if(1&n&&(t.j41(0,"th"),t.EFF(1),t.k0s()),2&n){const e=r.$implicit;t.R7$(),t.JRh(e)}}function M(n,r){if(1&n&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&n){const e=r.$implicit,o=t.XpG().$implicit;t.R7$(),t.SpI(" ",o[e]," ")}}function N(n,r){if(1&n&&(t.j41(0,"tr"),t.DNE(1,M,2,1,"td",20),t.k0s()),2&n){const e=t.XpG(3);t.R7$(),t.Y8G("ngForOf",e.tableTitle)}}function L(n,r){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"mat-accordion")(2,"mat-expansion-panel",7)(3,"mat-expansion-panel-header")(4,"mat-panel-title"),t.EFF(5," More about the requirements "),t.k0s()(),t.j41(6,"p",8)(7,"span",9)(8,"strong"),t.EFF(9,"Req Id"),t.k0s()(),t.j41(10,"span",10),t.EFF(11),t.k0s()(),t.j41(12,"p",8)(13,"span",9)(14,"strong"),t.EFF(15,"Title"),t.k0s()(),t.j41(16,"span",10),t.EFF(17),t.k0s()(),t.j41(18,"p",8)(19,"span",9)(20,"strong"),t.EFF(21,"Module Name"),t.k0s()(),t.j41(22,"span",10),t.EFF(23),t.k0s()(),t.j41(24,"p",8)(25,"span",9)(26,"strong"),t.EFF(27,"Priority"),t.k0s()(),t.j41(28,"span",10),t.EFF(29),t.k0s()(),t.j41(30,"p",8)(31,"span",9)(32,"strong"),t.EFF(33,"Status"),t.k0s()(),t.j41(34,"span",10),t.EFF(35),t.k0s()(),t.j41(36,"p",8)(37,"span",9)(38,"strong"),t.EFF(39,"Reviewer"),t.k0s()(),t.j41(40,"span",10),t.EFF(41),t.k0s()(),t.j41(42,"p",8)(43,"span",9)(44,"strong"),t.EFF(45,"Comments"),t.k0s()(),t.j41(46,"span",10),t.EFF(47),t.k0s()(),t.j41(48,"p",8)(49,"span",9)(50,"strong"),t.EFF(51,"File"),t.k0s()(),t.j41(52,"span",10),t.EFF(53),t.k0s()()()(),t.nrm(54,"br"),t.j41(55,"mat-accordion")(56,"mat-expansion-panel",11),t.bIt("opened",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.panelSwichState.set(!0))})("closed",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.panelSwichState.set(!1))}),t.j41(57,"mat-expansion-panel-header")(58,"mat-panel-title"),t.EFF(59),t.k0s()(),t.j41(60,"ckeditor",12),t.bIt("ready",function(i){t.eBV(e);const c=t.XpG(2);return t.Njj(c.onReady(i))}),t.k0s(),t.j41(61,"div",13)(62,"div",14)(63,"div",15)(64,"button",16),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.addComments())}),t.EFF(65," Add "),t.k0s(),t.j41(66,"button",17),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.resetForm())}),t.EFF(67," Reset "),t.k0s()()()(),t.DNE(68,P,21,4,"div",18),t.j41(69,"table",19)(70,"tr"),t.DNE(71,G,2,1,"th",20),t.k0s(),t.DNE(72,N,2,1,"tr",20),t.k0s()()()()}if(2&n){const e=t.XpG(2);t.R7$(2),t.Y8G("expanded",e.panelOpenState),t.R7$(9),t.JRh(e.data.id),t.R7$(6),t.JRh(e.data.title),t.R7$(6),t.JRh(e.data.mname),t.R7$(6),t.JRh(e.data.priority),t.R7$(6),t.JRh(e.data.status),t.R7$(6),t.JRh(e.data.reviewer),t.R7$(6),t.JRh(e.data.comments),t.R7$(6),t.JRh(e.data.file),t.R7$(6),t.SpI(" Comments (",e.comments.length,") "),t.R7$(),t.Y8G("editor",e.Editor),t.R7$(8),t.Y8G("ngForOf",e.comments),t.R7$(3),t.Y8G("ngForOf",e.tableTitle),t.R7$(),t.Y8G("ngForOf",e.tableRecords)}}function q(n,r){if(1&n&&(t.j41(0,"div",34)(1,"div",22),t.nrm(2,"img",23),t.j41(3,"span",24),t.EFF(4,"Surya - "),t.k0s(),t.j41(5,"span",25),t.EFF(6),t.k0s(),t.nrm(7,"div",26),t.k0s(),t.nrm(8,"div",35),t.k0s()),2&n){const e=r.$implicit;t.R7$(6),t.JRh(e.timestamp),t.R7$(2),t.Y8G("innerHTML",e.detail,t.npT)}}function w(n,r){if(1&n&&(t.qex(0),t.DNE(1,q,9,2,"div",33),t.bVm()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.activityLog)}}function U(n,r){if(1&n&&(t.j41(0,"mat-tab",5),t.DNE(1,L,73,14,"div",6)(2,w,2,1,"ng-container",6),t.k0s()),2&n){const e=r.$implicit,o=t.XpG();t.Y8G("label",e.title),t.R7$(),t.Y8G("ngIf",o.data&&"Overview"==e.title),t.R7$(),t.Y8G("ngIf","Activity"===e.title)}}const X=[{path:"",component:(()=>{class n extends h.U_{constructor(e,o,i,c,g){super(),this.cdr=e,this.route=o,this.advanceTableService=i,this.location=c,this.fb=g,this.panelOpenState=!0,this.currentTimestamp="",this.comments=[],this.activityLog=[],this.isEditing=!1,this.editingIndex=null,this.lotsOfTabs=[{title:"Overview",content:"Content 1"},{title:"Activity",content:"Content 2"}],this.uploadedImageName=null,this.panelSwichState=(0,t.vPA)(!1),this.Editor=s(),this.recordsPerPage=10,this.tableRecords=[],this.pageStartCount=0,this.pageEndCount=10,this.totalPageCount=0}ngOnInit(){const e=this.location.getState();this.data=e.rowData,console.log(this.data),this.Form=this.fb.group({comments:[this.advanceTable1?.comments||""],editcomments:[this.advanceTable1?.editcomments||""]})}resetForm(){const e=this.Form.get("comments")?.value||"",o=this.stripSpecificHtmlTags(e);console.log({comments:o}),this.Form.reset({comments:""})}stripSpecificHtmlTags(e){return e.replace(/<\/?(b|i|p|ul|ol|li|strong|em)>/g,"")}addComments(){const e=this.Form.get("comments")?.value||"",o=this.formatDate(new Date);let i=`A comment was added: ${e}`;this.uploadedImageName&&(i=`A comment was added with file name: ${this.uploadedImageName}`,this.uploadedImageName=null),this.comments.push({text:e,timestamp:o}),this.logActivity("added",i,o),this.Form.reset()}formatDate(e){return`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)} ${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}:${("0"+e.getSeconds()).slice(-2)}`}editComment(e){this.editingIndex=e,this.Form.get("editcomments")?.setValue(this.comments[e].text)}onReady(e){e.plugins.get("FileRepository").createUploadAdapter=o=>new _(o,e.config,this)}updateComment(e){const o=this.comments[e].text,i=this.Form.get("editcomments")?.value||"",c=this.formatDate(new Date);this.comments[e].text=i,this.comments[e].timestamp=c,this.logActivity("edited",`The text for a comment was changed from <span>${o}</span> to <span>${i}</span>`,c),this.editingIndex=null,this.Form.get("editcomments")?.reset()}uploadData(e){console.log(e.target.files[0]);const o=e.target;if(1!==o.files.length)throw new Error("Cannot use multiple files");const i=new FileReader;i.readAsBinaryString(o.files[0]),i.onload=c=>{const v=x.LF(c.target.result,{type:"binary"}),k=x.Wp.sheet_to_json(v.Sheets[v.SheetNames[0]]);console.log(k),this.tableData=k,this.tableTitle=Object.keys(this.tableData[0]),this.tableRecords=this.tableData.slice(this.pageStartCount,this.pageEndCount),this.totalPageCount=this.tableData.length/this.recordsPerPage}}cancelEdit(){this.editingIndex=null,this.Form.get("editcomments")?.reset()}deleteComment(e){const o=this.comments[e].text,i=this.formatDate(new Date);this.comments.splice(e,1),this.logActivity("removed",`A comment was removed: <span>${o}</span>`,i)}logActivity(e,o,i){this.activityLog.push({action:e,detail:o,timestamp:i})}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(t.gRc),t.rXU(d.nX),t.rXU(j.m),t.rXU(p.aZ),t.rXU(m.ze))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-req-detail-screen"]],features:[t.Vt3],decls:6,vars:2,consts:[[1,"content"],[1,"content-block",2,"margin-top","-95px"],[1,"block-header"],[1,"register-form","m-4",3,"formGroup"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[4,"ngIf"],[3,"expanded"],[1,"req-id-container"],[1,"req-id-label"],[1,"req-id-value"],[3,"opened","closed"],["formControlName","comments",3,"ready","editor"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mt-4"],[1,"example-button-row"],["mat-raised-button","","tabindex","-1",1,"add-button",2,"float","right",3,"click"],["mat-raised-button","",1,"reset-button",2,"float","right","box-shadow","none",3,"click"],["class","comment-container",4,"ngFor","ngForOf"],["cellspacing","0","cellpadding","0"],[4,"ngFor","ngForOf"],[1,"comment-container"],[1,"comment-header"],["src","assets/images/user/user.jpg","alt","Avatar",1,"avatar"],[1,"comment-author"],[1,"comment-timestamp"],[1,"comment-actions"],["mat-icon-button","",3,"click"],[1,"comment-body"],[3,"innerHTML",4,"ngIf"],["formControlName","editcomments",3,"editor",4,"ngIf"],[3,"innerHTML"],["formControlName","editcomments",3,"editor"],["class","comment-container","style","background-color: white; margin-top: 2px",4,"ngFor","ngForOf"],[1,"comment-container",2,"background-color","white","margin-top","2px"],[1,"activity-detail",2,"margin-left","50px",3,"innerHTML"]],template:function(o,i){1&o&&(t.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"mat-tab-group"),t.DNE(5,U,3,3,"mat-tab",4),t.k0s()()()()()),2&o&&(t.R7$(3),t.Y8G("formGroup",i.Form),t.R7$(2),t.Y8G("ngForOf",i.lotsOfTabs))},dependencies:[p.Sq,p.bT,m.qT,m.BC,m.cb,m.j4,m.JD,D.$z,D.iY,f.BS,f.GK,f.Z2,f.WN,I.An,E.mq,E.T8,T.h],styles:["[_nghost-%COMP%]     .ck-editor__editable_inline{min-height:150px}.ck-editor__editable[_ngcontent-%COMP%]{min-height:400px}.reset-button[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #369fd9;border-color:#369fd9;color:#369fd9!important}.reset-button[_ngcontent-%COMP%]:hover{background-color:#369fd9;color:#fff!important}.add-button[_ngcontent-%COMP%]{background-color:#369fd9!important;border:1px solid #369fd9!important;border-color:#369fd9!important;color:#fff!important}.comment-container[_ngcontent-%COMP%]{border:1px solid #e0e0e0;padding:10px;margin-top:20px;border-radius:5px;background-color:#f9f9f9}.comment-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;margin-right:10px}.comment-author[_ngcontent-%COMP%]{font-weight:700;margin-right:5px}.comment-timestamp[_ngcontent-%COMP%]{color:#888}.comment-body[_ngcontent-%COMP%]{font-size:14px;margin-left:50px}.comment-actions[_ngcontent-%COMP%]{display:flex;gap:0px;margin-left:auto}.req-id-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.req-id-label[_ngcontent-%COMP%]{width:150px;flex-shrink:0}.req-id-value[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"]})}return n})()}];let Y=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[d.iI.forChild(X),d.iI]})}return n})(),B=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({providers:[F,j.m],imports:[p.MD,m.YN,m.X1,b.h,h.Gg,Y,R.PO,T.w]})}return n})()},5702:($,u,a)=>{a.d(u,{m:()=>F});var p=a(4412),m=a(1413),b=a(7468),h=a(1626),R=a(5248),t=a(4438);let F=(()=>{class d extends R.U_{constructor(s){super(),this.http=s,this.API_URL="https://a87d-210-18-182-133.ngrok-free.app/requirements",this.isTblLoading=!0,this.dataChange=new p.t([]),this.data$=this.dataChange.asObservable(),this.reqAddedSource=new m.B,this.reqAdded$=this.reqAddedSource.asObservable(),this.selectedItemCount=0,this.getAllAdvanceTables()}get data(){return this.dataChange.value}getDialogData(){return this.dialogData}getAllAdvanceTables(){this.subs.sink=this.http.get(this.API_URL).subscribe({next:s=>{console.log(s),this.isTblLoading=!1,this.dataChange.next(s)},error:s=>{this.isTblLoading=!1}})}getAllReq(){return this.http.get(this.API_URL)}refreshData(){this.getAllAdvanceTables()}getReqDashboard(){return this.http.get(this.API_URL)}addReq(s){const l=new h.Lr({"Content-Type":"application/json"});return this.http.post(this.API_URL,s,{headers:l})}editReq(s){const l=new h.Lr({"Content-Type":"application/json"});return this.http.put(`${this.API_URL}/${s.req_id}`,s,{headers:l})}emitReqAdded(){this.reqAddedSource.next()}getSelectedItemCount(){return this.selectedItemCount}updateSelectedItemCount(s){this.selectedItemCount=s}addAdvanceTable(s){this.dialogData=s}updateAdvanceTable(s){this.dialogData=s}deleteAdvanceTable(s){return console.log(s),this.http.delete(`${this.API_URL}/${s}`)}deleteMultipleAdvanceTables(s){const l=s.map(_=>this.http.delete(`${this.API_URL}/${_}`));return(0,b.p)(l)}static#t=this.\u0275fac=function(l){return new(l||d)(t.KVO(h.Qq))};static#e=this.\u0275prov=t.jDH({token:d,factory:d.\u0275fac})}return d})()}}]);